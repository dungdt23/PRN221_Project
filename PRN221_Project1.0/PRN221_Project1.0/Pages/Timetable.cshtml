@page
@model PRN221_Project1._0.Pages.TimetableModel
@{
    Layout = "_MainLayout";
}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="~/css/timetable.css" asp-append-version="true" />
<body>
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="schedule-table ">
                    <table class="table bg-white" id="timetable">
                        <thead>
                            <label for="year-select">Year:</label>
                            <select id="year-select"></select>
                            <label for="week-select">Week:</label>
                            <select id="week-select"></select>

                            <tr>
                                <th></th>
                                <th >Monday</th>
                                <th >Tuesday</th>
                                <th >Wednesday</th>
                                <th >Thursday</th>
                                <th >Friday</th>
                                <th >Saturday</th>
                                <th >Sunday</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="day">
                                    Slot 1
                                </td>
                                <td class="active ">
                                </td>
                                <td class="active ">
                                </td>
                                <td class="active ">
                                </td>
                                <td class="active ">
                                </td>
                                <td class="active ">
                                </td>
                                <td class="active ">
                                </td>
                                <td class="active ">
                                </td>
                            </tr>
                            <tr>
                                <td class="day">Slot 2</td>
                                <td></td>
                                <td class="active thursday">
                                    <h4>Cycling</h4>
                                    <p>11 am - 12 pm</p>
                                    <div class="hover">
                                        <h4>Cycling</h4>
                                        <p>11 am - 12 pm</p>
                                        <span>Tabitha Potter</span>
                                    </div>
                                </td>
                                <td class="active friday">
                                    <h4>Karate</h4>
                                    <p>03 pm - 05 pm</p>
                                    <div class="hover">
                                        <h4>Karate</h4>
                                        <p>03 pm - 05 pm</p>
                                        <span>Lester Gray</span>
                                    </div>
                                </td>
                                <td></td>
                                <td class="active saturday">
                                    <h4>Crossfit</h4>
                                    <p>07 pm - 08 pm</p>
                                    <div class="hover">
                                        <h4>Crossfit</h4>
                                        <p>07 pm - 08 pm</p>
                                        <span>Candi Yip</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td class="day">Slot 3</td>
                                <td class="active">
                                    <h4>Spinning</h4>
                                    <p>10 am - 11 am</p>
                                    <div class="hover">
                                        <h4>Spinning</h4>
                                        <p>10 am - 11 am</p>
                                        <span>Mary Cass</span>
                                    </div>
                                </td>
                                <td></td>
                                <td></td>
                                <td class="active">
                                    <h4>Bootcamp</h4>
                                    <p>05 pm - 06 pm</p>
                                    <div class="hover">
                                        <h4>Bootcamp</h4>
                                        <p>05 pm - 06 pm</p>
                                        <span>Brenda Mastropietro</span>
                                    </div>
                                </td>
                                <td class="active">
                                    <h4>Boxercise</h4>
                                    <p>07 pm - 08 pm</p>
                                    <div class="hover">
                                        <h4>Boxercise</h4>
                                        <p>07 pm - 08 pm</p>
                                        <span>Marlene Bruce</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td class="day">Slot 4</td>
                                <td class="active">
                                    <h4>Body Building</h4>
                                    <p>10 am - 12 pm</p>
                                    <div class="hover">
                                        <h4>Body Building</h4>
                                        <p>10 am - 12 pm</p>
                                        <span>Brenda Hester</span>
                                    </div>
                                </td>
                                <td></td>
                                <td class="active">
                                    <h4>Dance</h4>
                                    <p>03 pm - 05 pm</p>
                                    <div class="hover">
                                        <h4>Dance</h4>
                                        <p>03 pm - 05 pm</p>
                                        <span>Brian Ashworth</span>
                                    </div>
                                </td>
                                <td></td>
                                <td class="active">
                                    <h4>Health</h4>
                                    <p>07 pm - 08 pm</p>
                                    <div class="hover">
                                        <h4>Health</h4>
                                        <p>07 pm - 08 pm</p>
                                        <span>Mark Croteau</span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const years = [2022, 2023, 2024];

        // Define the day names and date format
        const daysOfWeek = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
        const dateFormat = new Intl.DateTimeFormat('en-US', { month: 'short', day: 'numeric' });

        // Populate the year and week select boxes
        const yearSelect = document.getElementById('year-select');
        years.forEach(year => {
            const option = document.createElement('option');
            option.value = year;
            option.text = year;
            yearSelect.appendChild(option);
        });
        const weekSelect = document.getElementById('week-select');
        const currentYear = parseInt(yearSelect.value);
        for (let i = 1; i <= 52; i++) {
            const monday = getMondayOfWeek(currentYear, i);
            const sunday = new Date(monday.getTime() + 6 * 24 * 60 * 60 * 1000);
            const option = document.createElement('option');
            option.value = i;
            option.text = `Week ${i} (${dateFormat.format(monday)} - ${dateFormat.format(sunday)})`;
            weekSelect.appendChild(option);
        }
        yearSelect.addEventListener('change', () => {
            const year = parseInt(yearSelect.value);
            weekSelect.innerHTML = '';
            for (let i = 1; i <= 52; i++) {
                const monday = getMondayOfWeek(year, i);
                const sunday = new Date(monday.getTime() + 6 * 24 * 60 * 60 * 1000);
                const option = document.createElement('option');
                option.value = i;
                option.text = `Week ${i} (${dateFormat.format(monday)} - ${dateFormat.format(sunday)})`;
                weekSelect.appendChild(option);
            }
        });
        yearSelect.addEventListener('change', () => {
            const year = parseInt(yearSelect.value);
            const week = parseInt(weekSelect.value);
            displayDaysOfWeek(year, week);
        });

        weekSelect.addEventListener('change', () => {
            const year = parseInt(yearSelect.value);
            const week = parseInt(weekSelect.value);
            displayDaysOfWeek(year, week);
        });


        // Get the date of the first day (Monday) of the specified week and year
        function getMondayOfWeek(year, week) {
            const januaryFirst = new Date(year, 0, 1);
            const daysOffset = (januaryFirst.getDay() > 0 ? januaryFirst.getDay() - 1 : 6);
            const firstMonday = new Date(year, 0, 1 + (7 - daysOffset));
            const weekMonday = new Date(firstMonday.getTime() + (week - 1) * 7 * 24 * 60 * 60 * 1000);
            return weekMonday;
        }

        // Populate the timetable with the schedule for the specified week and year
        function displayDaysOfWeek(year, week) {
            const dateFormat = new Intl.DateTimeFormat('en', { day: '2-digit', month: '2-digit' });
            const daysOfWeek = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
            const monday = getMondayOfWeek(year, week);
            const mondayHeader = document.querySelector('#timetable thead tr th:nth-child(2)');
            mondayHeader.textContent = `${daysOfWeek[0]} ${dateFormat.format(monday)}`;

            for (let i = 1; i < daysOfWeek.length; i++) {
                const day = new Date(monday);
                day.setDate(day.getDate() + i);
                const header = document.querySelector(`#timetable thead tr th:nth-child(${i + 2})`);
                header.textContent = `${daysOfWeek[i]} ${dateFormat.format(day)}`;
            }
        }
        function init() {
            const currentDate = new Date();
            const currentYear = currentDate.getFullYear();
            const currentWeek = currentDate.getMonth();
            displayDaysOfWeek(currentYear, currentWeek);
            yearSelect.value = currentYear;
            weekSelect.value = currentWeek;
        }
        init()

    </script>
</body>

